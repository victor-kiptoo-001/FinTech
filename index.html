<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fin-Tech Solutions Quotation</title>
    <style>
        /* --- VISUAL CONFIGURATION --- */
        :root {
            --brand-purple: #553c8b;
            --light-purple-bg: #ecebf3;
            --ui-bg: #2c3e50;
            --ui-btn-blue: #3498db;
            --ui-btn-green: #27ae60;
        }

        @page {
            size: A4;
            margin: 0;
        }

        body {
            background: #333;
            font-family: Calibri, 'Segoe UI', Candara, sans-serif;
            margin: 0;
            padding: 30px;
            display: flex;
            justify-content: center;
            min-height: 100vh;
        }

        /* --- THE A4 PAGE --- */
        .page {
            width: 210mm;
            height: 297mm; 
            background: white;
            padding: 15mm 15mm;
            box-sizing: border-box;
            position: relative;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        /* --- HEADER --- */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start; 
            margin-bottom: 25px;
        }

        .header-left h1 {
            color: var(--brand-purple);
            font-size: 28px;
            margin: 0 0 20px 0;
            font-weight: normal;
        }

        .meta-table {
            font-size: 12px;
            font-weight: bold;
            color: #000;
            border-collapse: collapse;
        }
        .meta-table td { padding: 2px 0; }
        .meta-label { padding-right: 15px; }

        /* --- LOGO IMAGE --- */
        .logo-img {
            width: 130px;
            height: 130px;
            object-fit: contain;
        }

        /* --- INFO BOXES --- */
        .info-section {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            height: 130px; 
        }

        .info-box {
            background-color: var(--light-purple-bg);
            border-radius: 8px;
            flex: 1;
            padding: 15px;
            font-size: 12px;
        }

        .info-box h3 {
            color: var(--brand-purple);
            margin: 0 0 10px 0;
            font-size: 14px;
            font-weight: normal;
        }

        .info-content { line-height: 1.5; color: #000; }

        /* --- TABLE --- */
        table.items-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12px;
            margin-bottom: 5px;
        }

        thead tr {
            background-color: var(--brand-purple);
            color: white;
            height: 32px;
        }

        th {
            font-weight: normal;
            text-align: left;
            padding: 5px 10px;
            border-right: 1px solid rgba(255,255,255,0.2);
        }
        th:last-child { border-right: none; }

        td { padding: 8px 10px; color: #000; }

        tbody tr:nth-child(even) { background-color: #f2f2f9; }
        
        .total-row-bg {
            background-color: #e6e6e6 !important;
            font-weight: bold;
        }

        .col-no { width: 25px; }
        .col-qty { width: 70px; text-align: center; }
        .col-price { width: 90px; text-align: center; }
        .col-amt { width: 110px; text-align: right; }

        /* --- TOTALS --- */
        .totals-section {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            margin-top: 10px;
            margin-bottom: 25px;
        }

        .amount-words { font-size: 11px; font-weight: bold; }

        .final-total {
            border-top: 2px solid #000;
            border-bottom: 2px solid #000;
            padding: 5px 0;
            display: flex;
            justify-content: space-between;
            width: 250px;
            font-weight: bold;
            font-size: 14px;
        }

        /* --- BANK --- */
        .bank-details {
            background-color: var(--light-purple-bg);
            border-radius: 8px;
            padding: 15px;
            width: 42%;
            font-size: 12px;
        }
        
        .bank-grid {
            display: grid;
            grid-template-columns: 90px 1fr;
            gap: 5px 0;
        }
        .bank-label { font-weight: bold; }

        /* --- FOOTER --- */
        .footer-wrapper {
            position: absolute;
            bottom: 15mm;
            left: 15mm;
            right: 15mm;
        }

        .footer-strip {
            border-top: 1px dotted #999;
            padding-top: 5px;
            display: flex;
            justify-content: space-between;
            font-size: 9px;
            color: #333;
            margin-bottom: 15px;
        }

        .terms { font-size: 10px; color: #333; }
        .terms h4 { color: #555; margin: 0 0 5px 0; font-size: 11px; }
        .terms-list { margin: 0; padding-left: 15px; line-height: 1.4; }

        /* --- UI CONTROLS --- */
        [contenteditable]:hover {
            outline: 2px solid #3498db;
            background: rgba(52, 152, 219, 0.1);
            cursor: text;
        }

        .controls {
            position: fixed;
            top: 30px;
            right: 30px;
            background: var(--ui-bg);
            color: white;
            padding: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.5);
            border-radius: 12px;
            width: 260px;
            z-index: 100;
        }

        .controls h3 { margin: 0 0 15px 0; text-align: center; color: #ecf0f1; }

        .btn {
            display: block;
            width: 100%;
            padding: 12px;
            margin-bottom: 10px;
            cursor: pointer;
            border: none;
            border-radius: 6px;
            font-weight: bold;
            font-size: 14px;
            transition: transform 0.1s;
        }
        .btn:hover { transform: translateY(-2px); }
        .btn-blue { background-color: var(--ui-btn-blue); color: white; }
        .btn-green { background-color: var(--ui-btn-green); color: white; }
        
        .helper-text { font-size: 11px; color: #bdc3c7; text-align: center; margin-top: 15px; font-style: italic; }

        @media print {
            body { background: none; margin: 0; padding: 0; display: block; }
            .page { box-shadow: none; margin: 0; width: 210mm; height: 297mm; page-break-after: always; }
            .controls { display: none !important; }
            [contenteditable]:hover { outline: none; background: none; }
        }
    </style>
</head>
<body>

    <!-- CONTROL PANEL (Visible on Screen, Hidden on Print) -->
    <div class="controls">
        <h3>‚öôÔ∏è CONTROLS</h3>
        <button class="btn btn-blue" onclick="calculate()">üîÑ RECALCULATE</button>
        <button class="btn btn-green" onclick="window.print()">‚¨áÔ∏è DOWNLOAD PDF</button>
        <div class="helper-text">Edit the document by clicking directly on the text areas.</div>
    </div>

    <!-- THE A4 DOCUMENT -->
    <div class="page">
        
        <!-- HEADER -->
        <div class="header">
            <div class="header-left">
                <h1>Quotation</h1>
                <table class="meta-table">
                    <tr><td class="meta-label">Quotation No #</td><td contenteditable="true"></td></tr>
                    <tr><td class="meta-label">Quotation Date</td><td contenteditable="true" id="date-field"></td></tr>
                    <tr><td class="meta-label">Valid Till Date</td><td contenteditable="true" id="valid-field"></td></tr>
                </table>
            </div>
            
            <!-- PERMANENT LOGO -->
            <!-- Vercel will look for 'LOGO.jpeg' in the root folder -->
            <div>
                <img src="LOGO.jpeg" alt="Fin-Tech Solutions" class="logo-img" onerror="this.style.display='none'; alert('Logo not found! Make sure LOGO.jpeg is in the same folder.');">
            </div>
        </div>

        <!-- INFO BOXES -->
        <div class="info-section">
            <div class="info-box">
                <h3>Quotation From</h3>
                <div class="info-content">
                    <strong>Fin-Tech Solutions</strong><br>
                    +254 714 558 073 / +254 788 906 949<br>
                    dukesamoei@gmail.com<br>
                    P.O.BOX 362-30100<br>
                    ELDORET, KENYA
                </div>
            </div>
            <div class="info-box" contenteditable="true">
                <h3>Quotation For</h3>
                <div class="info-content">
                    <br><br><br><br>
                </div>
            </div>
        </div>

        <!-- ITEMS TABLE -->
        <table class="items-table">
            <thead>
                <tr>
                    <th class="col-no"></th>
                    <th class="col-desc">Item</th>
                    <th class="col-qty">Quantity</th>
                    <th class="col-price">Unit Price</th>
                    <th class="col-amt">Amount</th>
                </tr>
            </thead>
            <tbody id="invoice-body">
                <!-- 10 Editable Rows -->
                <tr><td class="col-no">1.</td><td contenteditable="true"></td><td class="col-qty" contenteditable="true" onblur="calculate()"></td><td class="col-price" contenteditable="true" onblur="calculate()"></td><td class="col-amt"></td></tr>
                <tr><td class="col-no">2.</td><td contenteditable="true"></td><td class="col-qty" contenteditable="true" onblur="calculate()"></td><td class="col-price" contenteditable="true" onblur="calculate()"></td><td class="col-amt"></td></tr>
                <tr><td class="col-no">3.</td><td contenteditable="true"></td><td class="col-qty" contenteditable="true" onblur="calculate()"></td><td class="col-price" contenteditable="true" onblur="calculate()"></td><td class="col-amt"></td></tr>
                <tr><td class="col-no">4.</td><td contenteditable="true"></td><td class="col-qty" contenteditable="true" onblur="calculate()"></td><td class="col-price" contenteditable="true" onblur="calculate()"></td><td class="col-amt"></td></tr>
                <tr><td class="col-no">5.</td><td contenteditable="true"></td><td class="col-qty" contenteditable="true" onblur="calculate()"></td><td class="col-price" contenteditable="true" onblur="calculate()"></td><td class="col-amt"></td></tr>
                <tr><td class="col-no">6.</td><td contenteditable="true"></td><td class="col-qty" contenteditable="true" onblur="calculate()"></td><td class="col-price" contenteditable="true" onblur="calculate()"></td><td class="col-amt"></td></tr>
                <tr><td class="col-no">7.</td><td contenteditable="true"></td><td class="col-qty" contenteditable="true" onblur="calculate()"></td><td class="col-price" contenteditable="true" onblur="calculate()"></td><td class="col-amt"></td></tr>
                <tr><td class="col-no">8.</td><td contenteditable="true"></td><td class="col-qty" contenteditable="true" onblur="calculate()"></td><td class="col-price" contenteditable="true" onblur="calculate()"></td><td class="col-amt"></td></tr>
                <tr><td class="col-no">9.</td><td contenteditable="true"></td><td class="col-qty" contenteditable="true" onblur="calculate()"></td><td class="col-price" contenteditable="true" onblur="calculate()"></td><td class="col-amt"></td></tr>
                <tr><td class="col-no">10.</td><td contenteditable="true"></td><td class="col-qty" contenteditable="true" onblur="calculate()"></td><td class="col-price" contenteditable="true" onblur="calculate()"></td><td class="col-amt"></td></tr>

                <tr class="total-row-bg">
                    <td></td><td>Total</td><td></td><td></td>
                    <td class="col-amt" id="table-total-display"></td>
                </tr>
            </tbody>
        </table>

        <!-- TOTALS -->
        <div class="totals-section">
            <div class="amount-words">
                Total (in words) : <span id="words-output" style="text-transform: uppercase;"></span>
            </div>
            <div class="final-total">
                <span>TOTAL (KES)</span>
                <span id="final-total-display">KES 0.00</span>
            </div>
        </div>

        <!-- BANK DETAILS -->
        <div class="bank-details">
            <h3>Bank Details</h3>
            <div class="bank-grid">
                <span class="bank-label">ACC name</span><span>Duke Kimutai Samoei</span>
                <span class="bank-label">ACC no.</span><span>1022529494</span>
                <span class="bank-label">Bank</span><span>UNAITAS</span>
            </div>
        </div>

        <!-- FOOTER & TERMS -->
        <div class="footer-wrapper">
            <div class="footer-strip">
                <span>406653-O</span><span>33 783-3015</span><span>DUKE</span><span>Page 1 of 2</span>
            </div>
            <div class="terms">
                <h4>Terms and Conditions</h4>
                <div class="terms-list">
                    1. GUARANTEE 12 month waranty against manufacturing defects on above products<br>
                    2. MAINTENANCE/AFTER SALE SERVICES. Fin-Tech Solution is staffed with trained and skilled professionals who are skilled in repair maintenance of all products sold by us<br>
                    3. PAYMENT TERM. 60% upon confirmation of order and 40% upon completion or otherwise agreed.
                </div>
            </div>
        </div>

    </div>

    <!-- JAVASCRIPT LOGIC -->
    <script>
        // Set Default Date
        const today = new Date();
        document.getElementById('date-field').innerText = today.toLocaleDateString('en-GB', { day: 'numeric', month: 'short', year: 'numeric' });

        function calculate() {
            let total = 0;
            const rows = document.querySelectorAll('#invoice-body tr');

            rows.forEach((row, index) => {
                // Skip the last row (Total row)
                if (index === rows.length - 1) return;

                const qtyCell = row.cells[2];
                const priceCell = row.cells[3];
                const amtCell = row.cells[4];

                // Remove commas and non-numeric chars for calculation
                const qty = parseFloat(qtyCell.innerText.replace(/[^0-9.]/g, '')) || 0;
                const price = parseFloat(priceCell.innerText.replace(/[^0-9.]/g, '')) || 0;

                const lineTotal = qty * price;
                
                if (lineTotal > 0 || (qty > 0 || price > 0)) {
                    // Update visuals only if user entered data
                    if(qty > 0) qtyCell.innerText = qty;
                    // Format price nicely
                    if(price > 0) priceCell.innerText = price.toLocaleString('en-KE', {minimumFractionDigits: 0, maximumFractionDigits: 2});
                    
                    amtCell.innerText = lineTotal.toLocaleString('en-KE', {minimumFractionDigits: 2, maximumFractionDigits: 2});
                    total += lineTotal;
                } else {
                    amtCell.innerText = "";
                }
            });

            // Update Grand Totals
            const formattedTotal = total.toLocaleString('en-KE', {minimumFractionDigits: 2, maximumFractionDigits: 2});
            document.getElementById('table-total-display').innerText = formattedTotal;
            document.getElementById('final-total-display').innerText = "KES " + formattedTotal;
            
            // Number to Words Update
            if(total > 0) {
                document.getElementById('words-output').innerText = numberToWords(Math.floor(total)) + " SHILLINGS ONLY"; 
            } else {
                document.getElementById('words-output').innerText = "";
            }
        }

        // --- Simple Number to Words Converter ---
        function numberToWords(n) {
            if (n < 0) return false;
            single = ['', 'One', 'Two', 'Three', 'Four', 'Five', 'Six', 'Seven', 'Eight', 'Nine'];
            double = ['Ten', 'Eleven', 'Twelve', 'Thirteen', 'Fourteen', 'Fifteen', 'Sixteen', 'Seventeen', 'Eighteen', 'Nineteen'];
            tens = ['', '', 'Twenty', 'Thirty', 'Forty', 'Fifty', 'Sixty', 'Seventy', 'Eighty', 'Ninety'];
            formatTenth = (n) => {
                let s = n.toString();
                let t = "";
                if (s.length > 1) { t = tens[s[0]]; s = s.substring(1); }
                return t + (t ? (single[s] ? "-" + single[s] : "") : single[s]);
            };
            if (n < 10) return single[n];
            if (n < 20) return double[n % 10];
            if (n < 100) return formatTenth(n);
            if (n < 1000) return single[Math.floor(n / 100)] + " Hundred " + (n % 100 ? numberToWords(n % 100) : "");
            if (n < 1000000) return numberToWords(Math.floor(n / 1000)) + " Thousand " + (n % 1000 ? numberToWords(n % 1000) : "");
            return n.toString(); 
        }
    </script>
</body>
</html>